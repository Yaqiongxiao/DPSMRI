function a = rotation_ref_xyz(dim,forty)
% Takes the dimensions of a cube as argument and returns the array a which contains the indices to rotate a cube of that dimension.

%% Rotate over the X axis
X90=[];
for i=dim:-1:1
	for t=0:(dim-1)
		X90=[X90, i+t*dim^2];
	end

	% Use i as starting value for next loop
	y=i;
	for j=1:(dim-1)
		y=i+j*dim;
		for t=0:(dim-1)
			X90=[X90, y+t*dim^2];
		end
	end
end

X180=X90(X90);
X270=X180(X90);

% add X rotation 3 * 45 degrees
X45 = [2,3,12,5,6,15,8,9,18,1,11,21,4,14,24,7,17,27,10,19,20,13,22,23,16,25,26];
X135= X45(X90);
X225= X135(X90);
X315 = X225(X90);


% test whether ok:
%X360=X270(X90);
%all(X360(:)==cube(:))

%% Y rotation

Y90=[];
for i=0:(dim-1)
	y=dim^2*(dim-1)+1+i*dim;

	%Loop through other dimensions	
	for t=0:dim-1
		Y90=[Y90 (y-t*dim^2):(y-t*dim^2+dim-1)];
	end
end	

Y180=Y90(Y90);
Y270=Y180(Y90);

% Test if correct
%Y360=Y270(Y90);
%all(Y360(:)==Y360(:))

% Y rotation in 3*45 degrees
Y45 = [10,11,12,1,2,3,4,5,6,19,20,21,13,14,15,7,8,9,22,23,24,25,26,27,16,17,18];
Y135=Y45(Y90);
Y225=Y135(Y90);
Y315=Y225(Y90);

%% Z Rotation

Z90=[];
for i=dim:dim^2:dim^3
	% loop through other dimensions
	for t=0:dim-1
		Z90=[Z90, i+t*dim];
	end
	
	% Loop through other dimensions
	for j=i-1:-1:(i-dim+1)
	
		for t=0:dim-1
			Z90=[Z90, j+t*dim];
		end

	end
end

Z180=Z90(Z90);
Z270=Z180(Z90);

% test whether ok:
%Z360=Z270(Z90);
%all(Z360(:)==cube(:))

% Z rotation 3* 45 degrees
Z45= [2,3,6,1,5,9,4,7,8,11,12,15,10,14,18,13,16,17,20,21,24,19,23,27,22,25,26];
Z135= Z45(Z90);
Z225= Z135(Z90);
Z315= Z225(Z90);

%% Reflection over X axis
cube=1:dim^3;
cube=reshape(cube,dim,dim,dim);

Xref=[];
for i=1:dim
	t=flipud(cube(:,:,i));
	Xref=[Xref, reshape(t,1,dim^2)]; 
end

%% Reflect over Y axis
Yref=[];
for i=1:dim
	t=fliplr(cube(:,:,i));
	Yref=[Yref, reshape(t,1,dim^2)]; 
end

%% Reflect over Z axis
Zref=[];
for i=dim:-1:1
	Zref=[Zref, reshape(cube(:,:,i),1,dim^2)]; 
end

if forty ==1
	a=[[1:dim^3]',Y90',Y180',Y270',X90',X180',X270',Z90',Z180',Z270',Yref',Xref',Zref'];
elseif forty == 2
	a=[[1:3^3]',Y45', Y90',Y135', Y180',Y225',Y270',Y315',X45', X90',X135', X180',X225',X270',X315',Z45', Z90',Z135', Z180',Z225',Z270',Z315',Yref',Xref',Zref'];

elseif forty == 3
	a=[[1:3^3]',Y45',Y45(Xref)', Y45(Yref)', Y45(Zref)', Y90',Y90(Xref)',Y90(Yref)',Y90(Zref)',Y135', Y135(Xref)',Y135(Yref)',Y135(Zref)',Y180',Y180(Xref)',Y180(Yref)',Y180(Zref)',Y225',Y225(Xref)',Y225(Yref)',Y225(Zref)',Y270',Y270(Xref)',Y270(Yref)',Y270(Zref)',Y315',Y315(Xref)',Y315(Yref)',Y315(Zref)',X45', X45(Xref)',X45(Yref)',X45(Zref)',X90',X90(Xref)',X90(Yref)',X90(Zref)',X135', X135(Xref)',X135(Yref)',X135(Zref)',X180',X180(Xref)',X180(Yref)',X180(Zref)',X225',X225(Xref)',X225(Yref)',X225(Zref)',X270',X270(Xref)',X270(Yref)',X270(Zref)',X315',X315(Xref)',X315(Yref)',X315(Zref)',Z45', Z45(Xref)',Z45(Yref)',Z45(Zref)',Z90',Z90(Xref)',Z90(Yref)',Z90(Zref)',Z135', Z135(Xref)',Z135(Yref)',Z135(Zref)',Z180',Z180(Xref)',Z180(Yref)',Z180(Zref)',Z225',Z225(Xref)',Z225(Yref)',Z225(Zref)',Z270',Z270(Xref)',Z270(Yref)',Z270(Zref)',Z315',Z315(Xref)',Z315(Yref)',Z315(Zref)',Yref',Xref',Zref'];
end
% All possible combinations of rotations

	a=[[1:3^3]',Y45',Y45(X45)',Y45(Z45)',Y45(X90)',Y45(Z90)',Y45(X135)',Y45(Z135)',Y45(X180)',Y45(Z180)',Y45(X225)',Y45(Z225)',Y45(X270)',Y45(X270)', Y45(Z270)',Y45(Z270)',Y45(X315)',Y45(Z315)',Y90',Y90(X45)',Y90(Z45)',Y90(X90)',Y90(Z90)',Y90(X135)',Y90(Z135)',Y90(X180)',Y90(Z180)',Y90(X225)',Y90(Z225)',Y90(X270)',Y90(Z270)',Y90(X315)',Y90(Z315)',Y135',Y135(X45)',Y135(Z45)',Y135(X90)',Y135(Z90)',Y135(X135)',Y135(Z135)',Y135(X180)',Y135(Z180)',Y135(X225)',Y135(Z225)',Y135(Z270)',Y135(Z270)',Y135(X315)',Y135(Z315)',Y180',Y180(X45)',Y180(Z45)',Y180(X90)',Y180(Z90)',Y180(X135)',Y180(Z135)',Y180(X180)',Y180(Z180)',Y180(X225)',Y180(Z225)',Y180(Z270)',Y180(Z270)',Y180(X315)',Y180(Z315)',Y225',Y225(X45)',Y225(Z45)',Y225(X90)',Y225(Z90)',Y225(X135)',Y225(Z135)',Y225(X180)',Y225(Z180)',Y225(X225)',Y225(Z225)',Y225(Z270)',Y225(Z270)',Y225(X315)',Y225(Z315)',Y270',Y270(X45)',Y270(Z45)',Y270(X90)',Y270(Z90)',Y270(X135)',Y270(Z135)',Y270(X180)',Y270(Z180)',Y270(X225)',Y270(Z225)',Y270(Z270)',Y270(Z270)',Y270(X315)',Y270(Z315)',Y315',Y315(X45)',Y315(Z45)',Y315(X90)',Y315(Z90)',Y315(X135)',Y315(Z135)',Y315(X180)',Y315(Z180)',Y315(X225)',Y315(Z225)',Y315(X270)',Y315(Z270)',Y315(X315)',Y315(Z315)',X45',X45(Y45)',X45(Z45)',X45(Y90)',X45(Z90)',X45(Y135)',X45(Z135)',X45(Y180)',X45(Z180)',X45(Y225)',X45(Z225)',X45(Y270)',X45(Z270)',X45(Y315)',X45(Z315)',X90',X90(Y45)',X90(Z45)',X90(Y90)',X90(Z90)',X90(Y135)',X90(Z135)',X90(Y180)',X90(Z180)',X90(Y225)',X90(Z225)',X90(Y270)',X90(Z270)',X90(Y315)',X90(Z315)',X135',X135(Y45)',X135(Z45)',X135(Y90)',X135(Z90)',X135(Y135)',X135(Z135)',X135(Y180)',X135(Z180)',X135(Y225)',X135(Z225)',X135(Y270)',X135(Z270)',X135(Y315)',X135(Z315)',X180',X180(Y45)',X180(Z45)',X180(Y90)',X180(Z90)',X180(Y135)',X180(Z135)',X180(Y180)',X180(Z180)',X180(Y225)',X180(Z225)',X180(Y270)',X180(Z270)',X180(Y315)',X180(Z315)',X225',X225(Y45)',X225(Z45)',X225(Y90)',X225(Z90)',X225(Y135)',X225(Z135)',X225(Y180)',X225(Z180)',X225(Y225)',X225(Z225)',X225(Y270)',X225(Z270)',X225(Y315)',X225(Z315)',X270',X270(Y45)',X270(Z45)',X270(Y90)',X270(Z90)',X270(Y135)',X270(Z135)',X270(Y180)',X270(Z180)',X270(Y225)',X270(Z225)',X270(Y270)',X270(Z270)',X270(Y315)',X270(Z315)',X315',X315(Y45)',X315(Z45)',X315(Y90)',X315(Z90)',X315(Y135)',X315(Z135)',X315(Y180)',X315(Z180)',X315(Y225)',X315(Z225)',X315(Y270)',X315(Z270)',X315(Y315)',X315(Z315)',X315',X315(Y45)',X315(Z45)',X315(Y90)',X315(Z90)',X315(Y135)',X315(Z135)',X315(Y180)',X315(Z180)',X315(Y225)',X315(Z225)',X315(Y270)',X315(Z270)',X315(Y315)',X315(Z315)',Z45',Z45(Y45)',Z45(X45)',Z45(Y90)',Z45(X90)',Z45(Y135)',Z45(X135)',Z45(Y180)',Z45(X180)',Z45(Y225)',Z45(X225)',Z45(Y270)',Z45(X270)',Z45(Y315)',Z45(X315)',Z90',Z90(Y45)',Z90(X45)',Z90(Y90)',Z90(X90)',Z90(Y135)',Z90(X135)',Z90(Y180)',Z90(X180)',Z90(Y225)',Z90(X225)',Z90(Y270)',Z90(X270)',Z90(Y315)',Z90(X315)',Z135',Z135(Y45)',Z135(X45)',Z135(Y90)',Z135(X90)',Z135(Y135)',Z135(X135)',Z135(Y180)',Z135(X180)',Z135(Y225)',Z135(X225)',Z135(Y270)',Z135(X270)',Z135(Y315)',Z135(X315)',Z180',Z180(Y45)',Z180(X45)',Z180(Y90)',Z180(X90)',Z180(Y135)',Z180(X135)',Z180(Y180)',Z180(X180)',Z180(Y225)',Z180(X225)',Z180(Y270)',Z180(X270)',Z180(Y315)',Z180(X315)',Z225',Z225(Y45)',Z225(X45)',Z225(Y90)',Z225(X90)',Z225(Y135)',Z225(X135)',Z225(Y180)',Z225(X180)',Z225(Y225)',Z225(X225)',Z225(Y270)',Z225(X270)',Z225(Y315)',Z225(X315)',Z270',Z270(Y45)',Z270(X45)',Z270(Y90)',Z270(X90)',Z270(Y135)',Z270(X135)',Z270(Y180)',Z270(X180)',Z270(Y225)',Z270(X225)',Z270(Y270)',Z270(X270)',Z270(Y315)',Z270(X315)',Z315',Z315(Y45)',Z315(X45)',Z315(Y90)',Z315(X90)',Z315(Y135)',Z315(X135)',Z315(Y180)',Z315(X180)',Z315(Y225)',Z315(X225)',Z315(Y270)',Z315(X270)',Z315(Y315)',Z315(X315)',Yref',Xref',Zref'];


% All possible combinations of rotations and reflections
	a=[[1:3^3]',Y45',Y45(X45)',Y45(X45(Xref))',Y45(X45(Yref))',Y45(X45(Zref))',
Y45(Z45(Xref))',Y45(Z45(Yref))',Y45(Z45(Zref))',
Y45(X90(Xref))',Y45(X90(Yref))',Y45(X90(Zref))',
Y45(Z90(Xref)',Y45(Z90(Yref)',Y45(Z90(Zref)',
Y45(X135(Xref))',Y45(X135(Yref))',Y45(X135(Zref))',
Y45(Z135(Xref))',Y45(Z135(Yref))',Y45(Z135(Zref))',
Y45(X180(Xref))',Y45(X180(Yref))',Y45(X180(Zref))',
Y45(Z180(Xref))',Y45(Z180(Yref))',Y45(Z180(Zref))',
Y45(X225(Xref))',Y45(X225(Yref))',Y45(X225(Zref))',
Y45(Z225(Xref))',Y45(Z225(Yref))',Y45(Z225(Zref))',
Y45(X270(Xref))',Y45(X270(Yref))',Y45(X270(Zref))',
Y45(Z270(Xref))',Y45(Z270(Yref))',Y45(Z270(Zref))',
Y45(X315(Xref))',Y45(X315(Yref))',Y45(X315(Zref))',
Y45(Z315(Xref))',Y45(Z315(Yref))',Y45(Z315(Zref))',
Y90',Y90(X45(Xref)',Y90(X45(Yref)',Y90(X45(Zref)',
Y90(Z45(Xref))',Y90(Z45(Yref))',Y90(Z45(Zref))',
Y90(X90(Xref))',Y90(X90(Yref))',Y90(X90(Zref))',
Y90(Z90(Xref))',Y90(Z90(Yref))',Y90(Z90(Zref))',
Y90(X135(Xref))',Y90(X135(Yref))',Y90(X135(Zref))',
Y90(Z135(Xref))',Y90(Z135(Yref))',Y90(Z135(Zref))',
Y90(X180(Xref))',Y90(X180(Yref))',Y90(X180(Zref))',
Y90(Z180(Xref))',Y90(Z180(Yref))',Y90(Z180(Zref))',
Y90(X225(Xref))',Y90(X225(Yref))',Y90(X225(Zref))',
Y90(Z225(Xref))',Y90(Z225(Yref))',Y90(Z225(Zref))',
Y90(X270(Xref))',Y90(X270(Yref))',Y90(X270(Zref))',
Y90(Z270(Xref))',Y90(Z270(Yref))',Y90(Z270(Zref))',
Y90(X315(Xref))',Y90(X315(Yref))',Y90(X315(Zref))',
Y90(Z315(Xref))',Y90(Z315(Yref))',Y90(Z315(Zref))',
Y135',Y135(X45(Xref))',Y135(X45(Yref))',Y135(X45(Zref))',
Y135(Z45(Xref))',Y135(Z45(Yref))',Y135(Z45(Zref))',
Y135(X90(Xref))',Y135(X90(Yref))',Y135(X90(Zref))',
Y135(Z90(Xref))',Y135(Z90(Yref))',Y135(Z90(Zref))',
Y135(X135(Xref))',Y135(X135(Yref))',Y135(X135(Zref))',Ã©
Y135(Z135(Xref))',Y135(Z135(Yref))',Y135(Z135(Zref))',
Y135(X180(Xref))',Y135(X180(Yref))',Y135(X180(Zref))',
Y135(Z180(Xref))',Y135(Z180(Yref))',Y135(Z180(Zref))',
Y135(X225(Xref))',Y135(X225(Yref))',Y135(X225(Zref))',
Y135(Z225(Xref))',Y135(Z225(Yref))',Y135(Z225(Zref))',
Y135(X270(Xref))',Y135(X270(Yref))',Y135(X270(Zref))',
Y135(Z270(Xref))',Y135(Z270(Yref))',Y135(Z270(Zref))',
Y135(X315(Xref))',Y135(X315(Yref))',Y135(X315(Zref))',
Y135(Z315(Xref))',Y135(Z315(Yref))',Y135(Z315(Zref))',
Y180',Y180(X45(Xref))',Y180(X45(Yref))',Y180(X45(Zref))',
Y180(Z45(Xref))',Y180(Z45(Yref))',Y180(Z45(Zref))',
Y180(X90(Xref))',Y180(X90(Yref))',Y180(X90(Zref))',
Y180(Z90(Xref))',Y180(Z90(Yref))',Y180(Z90(Zref))',
Y180(X135(Xref))',Y180(X135(Zref))',Y180(X135(Zref))',
Y180(Z135)',Y180(X180)',Y180(Z180)',Y180(X225)',Y180(Z225)',Y180(Z270)',Y180(Z270)',Y180(X315)',Y180(Z315)',Y225',Y225(X45)',Y225(Z45)',Y225(X90)',Y225(Z90)',Y225(X135)',Y225(Z135)',Y225(X180)',Y225(Z180)',Y225(X225)',Y225(Z225)',Y225(Z270)',Y225(Z270)',Y225(X315)',Y225(Z315)',Y270',Y270(X45)',Y270(Z45)',Y270(X90)',Y270(Z90)',Y270(X135)',Y270(Z135)',Y270(X180)',Y270(Z180)',Y270(X225)',Y270(Z225)',Y270(Z270)',Y270(Z270)',Y270(X315)',Y270(Z315)',Y315',Y315(X45)',Y315(Z45)',Y315(X90)',Y315(Z90)',Y315(X135)',Y315(Z135)',Y315(X180)',Y315(Z180)',Y315(X225)',Y315(Z225)',Y315(Z270)',Y315(Z270)',Y315(X315)',Y315(Z315)',X45',X45(Y45)',X45(Z45)',X45(Y90)',X45(Z90)',X45(Y135)',X45(Z135)',X45(Y180)',X45(Z180)',X45(Y225)',X45(Z225)',X45(Y270)',X45(Z270)',X45(Y315)',X45(Z315)',X90',X90(Y45)',X90(Z45)',X90(Y90)',X90(Z90)',X90(Y135)',X90(Z135)',X90(Y180)',X90(Z180)',X90(Y225)',X90(Z225)',X90(Y270)',X90(Z270)',X90(Y315)',X90(Z315)',X135',X135(Y45)',X135(Z45)',X135(Y90)',X135(Z90)',X135(Y135)',X135(Z135)',X135(Y180)',X135(Z180)',X135(Y225)',X135(Z225)',X135(Y270)',X135(Z270)',X135(Y315)',X135(Z315)',X180',X180(Y45)',X180(Z45)',X180(Y90)',X180(Z90)',X180(Y135)',X180(Z135)',X180(Y180)',X180(Z180)',X180(Y225)',X180(Z225)',X180(Y270)',X180(Z270)',X180(Y315)',X180(Z315)',X225',X225(Y45)',X225(Z45)',X225(Y90)',X225(Z90)',X225(Y135)',X225(Z135)',X225(Y180)',X225(Z180)',X225(Y225)',X225(Z225)',X225(Y270)',X225(Z270)',X225(Y315)',X225(Z315)',X270',X270(Y45)',X270(Z45)',X270(Y90)',X270(Z90)',X270(Y135)',X270(Z135)',X270(Y180)',X270(Z180)',X270(Y225)',X270(Z225)',X270(Y270)',X270(Z270)',X270(Y315)',X270(Z315)',X315',X315(Y45)',X315(Z45)',X315(Y90)',X315(Z90)',X315(Y135)',X315(Z135)',X315(Y180)',X315(Z180)',X315(Y225)',X315(Z225)',X315(Y270)',X315(Z270)',X315(Y315)',X315(Z315)',X315',X315(Y45)',X315(Z45)',X315(Y90)',X315(Z90)',X315(Y135)',X315(Z135)',X315(Y180)',X315(Z180)',X315(Y225)',X315(Z225)',X315(Y270)',X315(Z270)',X315(Y315)',X315(Z315)',Z45',Z45(Y45)',Z45(X45)',Z45(Y90)',Z45(X90)',Z45(Y135)',Z45(X135)',Z45(Y180)',Z45(X180)',Z45(Y225)',Z45(X225)',Z45(Y270)',Z45(X270)',Z45(Y315)',Z45(X315)',Z90',Z90(Y45)',Z90(X45)',Z90(Y90)',Z90(X90)',Z90(Y135)',Z90(X135)',Z90(Y180)',Z90(X180)',Z90(Y225)',Z90(X225)',Z90(Y270)',Z90(X270)',Z90(Y315)',Z90(X315)',Z135',Z135(Y45)',Z135(X45)',Z135(Y90)',Z135(X90)',Z135(Y135)',Z135(X135)',Z135(Y180)',Z135(X180)',Z135(Y225)',Z135(X225)',Z135(Y270)',Z135(X270)',Z135(Y315)',Z135(X315)',Z180',Z180(Y45)',Z180(X45)',Z180(Y90)',Z180(X90)',Z180(Y135)',Z180(X135)',Z180(Y180)',Z180(X180)',Z180(Y225)',Z180(X225)',Z180(Y270)',Z180(X270)',Z180(Y315)',Z180(X315)',Z225',Z225(Y45)',Z225(X45)',Z225(Y90)',Z225(X90)',Z225(Y135)',Z225(X135)',Z225(Y180)',Z225(X180)',Z225(Y225)',Z225(X225)',Z225(Y270)',Z225(X270)',Z225(Y315)',Z225(X315)',Z270',Z270(Y45)',Z270(X45)',Z270(Y90)',Z270(X90)',Z270(Y135)',Z270(X135)',Z270(Y180)',Z270(X180)',Z270(Y225)',Z270(X225)',Z270(Y270)',Z270(X270)',Z270(Y315)',Z270(X315)',Z315',Z315(Y45)',Z315(X45)',Z315(Y90)',Z315(X90)',Z315(Y135)',Z315(X135)',Z315(Y180)',Z315(X180)',Z315(Y225)',Z315(X225)',Z315(Y270)',Z315(X270)',Z315(Y315)',Z315(X315)',Yref',Xref',Zref'];



	a=[[1:3^3]',Y45',Y45(Xref)', Y45(Yref)', Y45(Zref)', Y90',Y90(Xref)',Y90(Yref)',Y90(Zref)',Y135', Y135(Xref)',Y135(Yref)',Y135(Zref)',Y180',Y180(Xref)',Y180(Yref)',Y180(Zref)',Y225',Y225(Xref)',Y225(Yref)',Y225(Zref)',Y270',Y270(Xref)',Y270(Yref)',Y270(Zref)',Y315',Y315(Xref)',Y315(Yref)',Y315(Zref)',X45', X45(Xref)',X45(Yref)',X45(Zref)',X90',X90(Xref)',X90(Yref)',X90(Zref)',X135', X135(Xref)',X135(Yref)',X135(Zref)',X180',X180(Xref)',X180(Yref)',X180(Zref)',X225',X225(Xref)',X225(Yref)',X225(Zref)',X270',X270(Xref)',X270(Yref)',X270(Zref)',X315',X315(Xref)',X315(Yref)',X315(Zref)',Z45', Z45(Xref)',Z45(Yref)',Z45(Zref)',Z90',Z90(Xref)',Z90(Yref)',Z90(Zref)',Z135', Z135(Xref)',Z135(Yref)',Z135(Zref)',Z180',Z180(Xref)',Z180(Yref)',Z180(Zref)',Z225',Z225(Xref)',Z225(Yref)',Z225(Zref)',Z270',Z270(Xref)',Z270(Yref)',Z270(Zref)',Z315',Z315(Xref)',Z315(Yref)',Z315(Zref)',Yref',Xref',Zref'];

end